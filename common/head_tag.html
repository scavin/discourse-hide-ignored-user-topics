<script type="text/discourse-plugin" version="1.6.0">

// 创建样式元素以隐藏被忽略用户的主题项
const styleElement = document.createElement("style");

// 获取当前用户的被忽略用户列表
const ignoredUsers = api.getCurrentUser()?.ignored_users || [];

// 确保 ignoredUsers 是一个数组
if (Array.isArray(ignoredUsers)) {
    // 为每个被忽略用户生成 CSS 规则，隐藏其创建的主题
    ignoredUsers.forEach(user => {
        styleElement.innerHTML += `tr.topic-list-item[data-creator-name="${user}"] { display: none; }`;
    });
}

// 将样式元素添加到文档中
document.head.appendChild(styleElement);

// 注册值转换器以过滤主题列表
api.registerValueTransformer('topic-list-columns', (columns) => {
    // 确保 columns 是一个数组
    if (!Array.isArray(columns)) {
        return columns; // 如果不是数组，直接返回
    }
    
    // 过滤掉被忽略用户的主题
    return columns.filter(topic => !ignoredUsers.includes(topic.creator.username));
});

</script>
