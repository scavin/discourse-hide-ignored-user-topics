<script type="text/discourse-plugin" version="1.6.0">

const { alias } = require("@ember/object/computed");

api.modifyClass("component:topic-list-item", {
    pluginId: "remove-ignored-users-topic",
    attributeBindings: ["data-topic-id", "role", "ariaLevel:aria-level", "data-creator-name"],
    "data-creator-name": alias("topic.creator.username"),
});

// 使用新的主题列表 API 来隐藏忽略的用户主题
if (api.getCurrentUser()) {
    const ignoredUsers = api.getCurrentUser().ignored_users;

    // 通过 API 修改主题列表的类，而不是直接修改样式
    api.addStyle(ignoredUsers.map(u => `tr[data-creator-name="${u}"] { display: none; }`).join("\n"));
}

</script>
